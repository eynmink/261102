#include <iostream>
#include <conio.h>
#include <windows.h>
#include <string>

using namespace std;

// à¸‚à¸™à¸²à¸”à¸‰à¸²à¸
const int WIDTH = 40;
const int HEIGHT = 15;

// à¸•à¸³à¹à¸«à¸™à¹ˆà¸‡à¹„à¸”à¹‚à¸™
int x = WIDTH / 2;
int y = HEIGHT / 2;

// à¸¢à¹‰à¸²à¸¢à¹€à¸„à¸­à¸£à¹Œà¹€à¸‹à¸­à¸£à¹Œ
void gotoXY(int x, int y) {
    COORD c;
    c.X = x;
    c.Y = y;
    SetConsoleCursorPosition(GetStdHandle(STD_OUTPUT_HANDLE), c);
}

// à¸§à¸²à¸”à¸‰à¸²à¸à¹à¸šà¸š Double Buffer
void draw() {
    string buffer;

    for (int row = HEIGHT; row >= 0; row--) {
        for (int col = 0; col < WIDTH; col++) {
            if (row == y && col == x)
                buffer += "ðŸ¦–";
            else
                buffer += " ";
        }
        buffer += "\n";
    }

    gotoXY(0, 0);
    cout << buffer;
}

int main() {
    // à¹€à¸›à¸´à¸” UTF-8
    SetConsoleOutputCP(CP_UTF8);

    // à¸‹à¹ˆà¸­à¸™à¹€à¸„à¸­à¸£à¹Œà¹€à¸‹à¸­à¸£à¹Œ (à¹€à¸™à¸µà¸¢à¸™à¸‚à¸¶à¹‰à¸™)
    CONSOLE_CURSOR_INFO cursor;
    cursor.bVisible = false;
    cursor.dwSize = 1;
    SetConsoleCursorInfo(GetStdHandle(STD_OUTPUT_HANDLE), &cursor);

    draw();

    while (true) {
        if (kbhit()) {
            char key = getch();

            if (key == 'w' || key == 'W') y++;
            if (key == 's' || key == 'S') y--;
            if (key == 'a' || key == 'A') x--;
            if (key == 'd' || key == 'D') x++;

            // à¸à¸±à¸™à¸­à¸­à¸à¸™à¸­à¸à¸ˆà¸­
            if (x < 0) x = 0;
            if (x >= WIDTH) x = WIDTH - 1;
            if (y < 0) y = 0;
            if (y >= HEIGHT) y = HEIGHT - 1;

            draw();
        }

        Sleep(10);
    }

    return 0;
}

